import{l as H,w as J,c as L,u as M,a as N,d as O,p as S,b as W,e as E,s as x,f as _,g as i,h as o,i as h,t as y,j as $,k as q,m as G,n as K,o as Q}from"./disclose-version-mPVtRhrL.js";import{i as X,e as R,a as U}from"./each-B6yZeq2V.js";import{f as g,a as m,s as v,d as n,b as V,c as Y,e as Z,g as ee}from"./dock_data.svelte-D8xrDy0e.js";function te(l){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function C(l,c){H(window,["resize"],()=>J(()=>c(window[l])))}function ae(l){L===null&&te(),M(()=>{const c=N(l);if(typeof c=="function")return c})}var ne=g('<div role="link" aria-label="Change Page"><img alt="Illustration"/> <div class="h-full w-full flex flex-col justify-center text-center"><div class="p-6"><p> </p></div> <div class="h-18"></div></div></div>'),ie=g('<div class="h-screen w-full flex flex-col justify-center"><div class="w-full flex justify-center mb-4"><span class="loading loading-ring loading-xl"></span></div> <div class="w-full flex justify-center"><progress class="progress progress-primary w-56"></progress></div></div>'),re=g('<audio preload="auto"></audio>'),se=g("<main><!> <!></main>");function oe(l,c){W(c,!0);let I=_(!0),k=_(0),b=_(0),z=$(()=>i(k)>i(b)?"flex-row":"flex-col");const d=JSON.parse(document.getElementById("pages-data").textContent);let w=_(0),j=0;ae(async()=>{const t=d.map(e=>new Promise((a,r)=>{const s=new Image;s.src=e.image,s.onload=()=>{E(w),a(e.image),console.log(performance.now())},s.onerror=()=>{E(w),console.log(`Failed to fetch ${e.image}`),a(e.image)}}));await Promise.all(t),await new Promise(e=>setTimeout(e,300)),x(I,!1)});function p(t){const e=performance.now();if(e-j>500){if(n.currentIndex>0){let a=document.getElementById(`audio-${n.currentIndex}`);a&&(a.pause(),a.currentTime=0)}if(t.clientX>window.screen.width/4&&n.currentIndex<d.length-1){n.currentIndex++;let a=document.getElementById(`audio-${n.currentIndex}`);a&&n.sound&&a.play()}else t.clientX<window.screen.width/4&&n.currentIndex>0&&n.currentIndex--;j=e}}var P=se(),B=o(P);{var D=t=>{var e=ne();e.__click=p,e.__keyup=F=>F.key==="ArrowLeft"?p({clientX:0}):p({clientX:1e4});var a=o(e),r=h(a,2),s=o(r),f=o(s),u=o(f);y(()=>{v(e,"tabindex",n.currentIndex),V(e,1,Y(["h-screen flex",i(z)])),v(a,"src",d[n.currentIndex].image),q(u,d[n.currentIndex].text)}),m(t,e)},T=t=>{var e=ie(),a=h(o(e),2),r=o(a);y(()=>{Z(r,i(w)),v(r,"max",d.length)}),m(t,e)};X(B,t=>{i(I)?t(T,!1):t(D)})}var A=h(B,2);R(A,17,()=>d,U,(t,e)=>{var a=ee(),r=G(a);{var s=f=>{var u=re();y(()=>{v(u,"id",i(e).audio.id),v(u,"src",i(e).audio.url)}),K("ended",u,()=>{n.autoplay&&p({clientX:1e4})}),m(f,u)};X(r,f=>{i(e).audio&&f(s)})}m(t,a)}),C("innerWidth",t=>x(k,t,!0)),C("innerHeight",t=>x(b,t,!0)),m(l,P),S()}O(["click","keyup"]);Q(oe,{target:document.getElementById("book_detail")});
