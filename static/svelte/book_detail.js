import{l as L,w as M,c as N,u as O,a as W,d as $,p as G,b as K,e as B,s as x,f as _,g as n,h as o,i as h,j as Q,t as y,k as R,m as U,n as E,o as V,q as Y}from"./disclose-version-vnJr-nxA.js";import{i as C,e as Z,a as ee}from"./each-BMTP-u2y.js";import{f as g,a as p,d as i,s as v,b as te,c as ae,e as ie,g as ne}from"./dock_data.svelte-CSo1fuPg.js";import{u as re}from"./index.esm.svelte-BzAfiaG2.js";function se(l){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function D(l,c){L(window,["resize"],()=>M(()=>c(window[l])))}function oe(l){N===null&&se(),O(()=>{const c=W(l);if(typeof c=="function")return c})}var le=g('<div role="link" aria-label="Change Page"><img alt="Illustration"/> <div class="h-full w-full flex flex-col justify-center text-center"><div class="p-6"><p> </p></div> <div class="h-18"></div></div></div>'),ce=g('<div class="h-screen w-full flex flex-col justify-center"><div class="w-full flex justify-center mb-4"><span class="loading loading-ring loading-xl"></span></div> <div class="w-full flex justify-center"><progress class="progress progress-primary w-56"></progress></div></div>'),de=g('<audio preload="auto"></audio>'),ue=g("<main><!> <!></main>");function fe(l,c){K(c,!0);let I=_(!0),k=_(0),b=_(0),S=R(()=>n(k)>n(b)?"flex-row":"flex-col");const d=JSON.parse(document.getElementById("pages-data").textContent);let w=_(0),X=0;oe(async()=>{const t=d.map(e=>new Promise((a,r)=>{const s=new Image;s.src=e.image,s.onload=()=>{B(w),a(e.image)},s.onerror=()=>{B(w),console.log(`Failed to fetch ${e.image}`),a(e.image)}}));await Promise.all(t),await new Promise(e=>setTimeout(e,300)),x(I,!1)});function u(t){const e=performance.now();if(e-X>500){if(i.currentIndex>0){let a=document.getElementById(`audio-${i.currentIndex}`);a&&(a.pause(),a.currentTime=0)}if(t.clientX>window.screen.width/4&&i.currentIndex<d.length-1){i.currentIndex++;let a=document.getElementById(`audio-${i.currentIndex}`);a&&i.sound&&a.play()}else t.clientX<window.screen.width/4&&i.currentIndex>0&&i.currentIndex--;X=e}}function z(t){t.detail.direction==="right"?u({clientX:0}):u({clientX:1e4})}const{swipe:A,onswipe:H}=re(z,()=>({timeframe:500,minSwipeDistance:50,touchAction:"pan-y"}),{},!0);var j=ue(),P=o(j);{var T=t=>{var e=le();e.__click=u,e.__keyup=J=>J.key==="ArrowLeft"?u({clientX:0}):u({clientX:1e4});var a=o(e),r=h(a,2),s=o(r),m=o(s),f=o(m);Q(e,()=>A),y(()=>{v(e,"tabindex",i.currentIndex),te(e,1,ae(["h-screen flex",n(S)])),v(a,"src",d[i.currentIndex].image),U(f,d[i.currentIndex].text)}),E("swipe",e,H),p(t,e)},q=t=>{var e=ce(),a=h(o(e),2),r=o(a);y(()=>{ie(r,n(w)),v(r,"max",d.length)}),p(t,e)};C(P,t=>{n(I)?t(q,!1):t(T)})}var F=h(P,2);Z(F,17,()=>d,ee,(t,e)=>{var a=ne(),r=V(a);{var s=m=>{var f=de();y(()=>{v(f,"id",n(e).audio.id),v(f,"src",n(e).audio.url)}),E("ended",f,()=>{i.autoplay&&u({clientX:1e4})}),p(m,f)};C(r,m=>{n(e).audio&&m(s)})}p(t,a)}),D("innerWidth",t=>x(k,t,!0)),D("innerHeight",t=>x(b,t,!0)),p(l,j),G()}$(["click","keyup"]);Y(fe,{target:document.getElementById("book_detail")});
